# 前端数据库展示优化方案 (Refined v2)

## 1. 目标

根据 `design-doc/优化前端数据库展示/方案.md` 的需求：
1.  **数据库展示优化**：解决大量物种/数据库的筛选和展示问题
2.  **导航栏清理**：去掉冗余的"序列比对"链接
3.  **界面风格**：调整为更简洁的学术风格

---

## 2. 现状分析

### 2.1 当前数据结构 (`databases.yaml`)
```yaml
test_ref.fa:
  species: "oryza_sativa"
  genome_version: "IRGSP-1.0"
  sequence_type: "genome"
```
- 已有 `species`, `genome_version`, `sequence_type` 字段
- 数据结构支持分层展示

### 2.2 当前前端实现 (`Home.vue`)
- 使用 `computed` 按 `species` 分组 (`groupedDatabases`)
- 使用嵌套 `v-for` 平铺展示所有物种和数据库
- **问题**：物种多时列表过长、无搜索、无法快速定位

### 2.3 当前样式
- 使用 Tailwind CSS
- 暗色主题 (`bg-slate-950`)
- 大量渐变、阴影效果

---

## 3. 优化方案

### 3.1 数据库选择器重构

#### 方案 A：分栏式主从布局 (Master-Detail) ⭐ 推荐
```
┌──────────────────────────────────────────────────┐
│  🔍 搜索物种...                                  │
├───────────────┬──────────────────────────────────┤
│ 物种列表      │ 数据库列表                        │
│───────────────│──────────────────────────────────│
│ ○ Oryza (2)   │ ☑ IRGSP-1.0 genome              │
│ ● Zea (3)     │ ☑ T2T-NIP genome                │
│ ○ Triticum(5) │ ☐ RefSeq cds                    │
│               │ [全选] [取消全选]                 │
└───────────────┴──────────────────────────────────┘
            已选 3 个数据库 ▾
```

**优点**：
- 物种列表紧凑，最多显示 10-15 项即可滚动
- 右侧只加载当前物种的数据库，性能好
- 支持跨物种选择，底部汇总显示

**实现细节**：
- 左侧：固定宽度 (200px)，可滚动
- 右侧：自适应宽度
- 底部：展开折叠已选列表

#### 方案 B：可折叠面板 (Accordion)
每个物种是一个可折叠的手风琴面板，点击展开数据库列表。

**缺点**：物种多时需要多次点击，体验较差。

> [!TIP]
> **推荐方案 A**，更符合大量数据的筛选场景。

---

### 3.2 导航栏清理

**当前代码** (`App.vue`):
```javascript
const navItems = [
  { name: '序列比对', path: '/', icon: Search },
];
```

**优化**：
- 清空 `navItems` 数组（或完全移除导航逻辑）
- 保留 Logo 和 HelpCircle 图标
- 简化 Navbar 高度

---

### 3.3 界面风格调整 (学术风)

#### 3.3.1 配色方案

| 元素       | 当前值               | 新值                     |
|------------|----------------------|--------------------------|
| 主背景     | `bg-slate-950`       | `bg-white` / `bg-gray-50`|
| 卡片背景   | `bg-slate-900/50`    | `bg-white border`        |
| 主文字     | `text-slate-100`     | `text-gray-800`          |
| 次文字     | `text-slate-400`     | `text-gray-500`          |
| 主色调     | Indigo 渐变          | `#2563eb` (Blue-600) 纯色|
| 边框       | 暗色阴影             | `border-gray-200`        |

#### 3.3.2 组件调整

- **卡片**：`rounded-2xl` → `rounded-lg`，去除 `shadow-xl`
- **按钮**：去除渐变，使用纯色 + hover 加深
- **输入框**：白色背景，清晰边框

#### 3.3.3 字体

当前已使用 Inter，保持不变。调整 `index.css` 中的基础颜色。

---

## 4. 影响范围分析

| 文件                              | 修改类型 | 说明                                  |
|-----------------------------------|----------|--------------------------------------|
| `tailwind.config.js`              | 修改     | 添加主题颜色变量                      |
| `src/index.css`                   | 修改     | 调整根元素颜色为浅色                  |
| `src/App.vue`                     | 修改     | 导航栏清理 + 主题调整                 |
| `src/pages/Home.vue`              | 修改     | 引入新组件 + 样式调整                 |
| `src/components/DatabaseSelector.vue` | 新增 | 新数据库选择器组件                    |

**无需修改后端**：数据结构已满足需求。

---

## 5. 任务列表 (Task List)

### Phase 1: 基础样式调整 (低风险)
- [x] **Task 1.1**: 修改 `tailwind.config.js`，添加学术主题色
- [x] **Task 1.2**: 修改 `index.css`，设置浅色背景基础
- [x] **Task 1.3**: 修改 `App.vue`
    - 清空 `navItems`
    - 调整 Navbar/Footer 为浅色主题

### Phase 2: 核心组件开发 (中风险)
- [x] **Task 2.1**: 创建 `DatabaseSelector.vue` 骨架
- [x] **Task 2.2**: 实现物种搜索过滤
- [x] **Task 2.3**: 实现多选逻辑与已选汇总
- [x] **Task 2.4**: 响应式布局 (移动端堆叠)

### Phase 3: 集成与收尾
- [x] **Task 3.1**: 在 `Home.vue` 中集成 `DatabaseSelector`
- [x] **Task 3.2**: 调整 `Home.vue` 其余区域样式
- [x] **Task 3.3**: 端到端测试 (选择 → 提交 → 结果)

---

## 6. 风险与缓解

| 风险                        | 影响 | 缓解措施                                  |
|-----------------------------|------|------------------------------------------|
| 主题切换导致样式遗漏        | 中   | 逐文件检查，使用浏览器开发者工具        |
| 选择器状态管理复杂          | 中   | 使用 `v-model` 双向绑定，保持父组件控制  |
| 移动端体验下降              | 低   | 使用 Tailwind 响应式类，优先调整断点     |

---

## 7. 验证计划

1. **视觉验证**：截图对比新旧界面
2. **功能验证**：
   - 搜索过滤物种
   - 跨物种选择数据库
   - 提交比对任务并查看结果
3. **性能验证**：使用 100+ 数据库模拟数据测试渲染性能
4. **响应式验证**：浏览器模拟移动设备

---

## 8. 后续可扩展方向 (非本次范围)

- [ ] 物种分类支持层级 (如 门/纲/目/科/属/种)
- [ ] 数据库收藏 / 常用列表
- [ ] 键盘快捷键 (↑↓ 选择物种，空格切换数据库)
